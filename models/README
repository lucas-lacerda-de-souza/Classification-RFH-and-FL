ğŸ§ Models

This folder contains all model implementations used in the Classification of Reactive Follicular Hyperplasia (RFH) and Follicular Lymphoma (FL) project.
It includes deep learning, multimodal, and classical machine learning architectures for image, clinical, and morphometric data integration.

ğŸ“˜ Model Categories
1. Multimodal Deep Learning

These scripts combine histopathological image features with clinical variables to improve diagnostic performance.

             Script                    â”‚     Level     â”‚                            **Description**
multimodal_alexnet_patch_level.py	     â”‚     Patch     â”‚       AlexNet architecture for patch-level multimodal fusion.
multimodal_alexnet_patient_level.py	   â”‚    Patient    â”‚         Aggregated patient-level model using mean feature pooling.
multimodal_resnet18_patch_level.py	   â”‚     Patch     â”‚   ResNet18-based model integrating local image patches and tabular data.
multimodal_resnet18_patient_level.py   â”‚    Patient    â”‚         ResNet18 model trained on patient-level aggregated embeddings.
multimodal_vgg16_patch_level.py	       â”‚     Patch     â”‚       VGG16 model for multimodal feature learning at the patch level.
multimodal_vgg16_patient_level.py	     â”‚    Patient    â”‚         VGG16 architecture applied at patient-level granularity.


All multimodal models include:
Late fusion between CNN features and clinical embeddings
Weighted loss functions for class imbalance
ROC/PR curve generation
Support for multi-GPU training (torch.nn.DataParallel)

2. Image Segmentation
Script	Description
segmentation_unet++.py	Implements U-Net++ with attention gates for tissue segmentation. 
This segmentation model is used to generate tissue masks for patch extraction and preprocessing.

3. Classical Machine Learning
Script	Description
xgboost_classification_cpc_mpa.py	XGBoost classifier trained on clinicopathologic and morphometric parameters.
xgboost_classification_gradcam.py	XGBoost model trained on Grad-CAM-derived features for interpretability and cross-validation.

Both scripts support:
Training/validation/test split
Feature importance plots
Confusion matrix and ROC/PR evaluation
CSV export of results to /results/

âš™ï¸ Usage Example
# Train a multimodal ResNet18 model (patch-level)
python multimodal_resnet18_patch_level.py \
  --data_dir ./data/train \
  --val_dir ./data/val \
  --epochs 50 \
  --batch_size 8 \
  --output_dir ./results/resnet18_patch/

# Run XGBoost Grad-CAM analysis
python xgboost_classification_gradcam.py \
  --input ./supplementary_data/supplementary_table_4.xlsx \
  --output ./results/xgboost_gradcam/

ğŸ“ Output Structure
results/

â”œâ”€â”€ resnet18_patch/

â”‚   â”œâ”€â”€ model.pth

â”‚   â”œâ”€â”€ metrics.csv

â”‚   â”œâ”€â”€ confusion_matrix.png

â”‚   â”œâ”€â”€ roc_curve.png

â”‚   â””â”€â”€ pr_curve.png

â”œâ”€â”€ unetpp_segmentation/

â”‚   â”œâ”€â”€ masks/

â”‚   â””â”€â”€ training_curves.png

â””â”€â”€ xgboost_gradcam/

    â”œâ”€â”€ feature_importance.png

    â”œâ”€â”€ shap_summary.png

    â””â”€â”€ performance_metrics.csv

ğŸ§¬ Reproducibility Notes

Python: 3.12.11
PyTorch: 2.8.0 + CUDA 12.8
GPU: 3 Ã— NVIDIA RTX 3090 (24 GB each)
OS: Ubuntu 20.04 LTS
RAM: 125 GB
Random seeds are fixed (torch, numpy, random) for deterministic behavior.
